---
title: Project Doris 中期总结
date: 2023-06-18 08:27:06
draft: false
featured: false
tags:
  - week
  - reading
postSlug: project-doris-mid-term-retro
---

今天 618，早起，清晨很凉爽，洗把脸冲杯冰咖啡，开始写这周的简报。

分别说说这周做的事情。

## Table of contents

## Leetcode

Leetcode 75 刷了 45 题，日记系列已经写了 9 篇，距离下周端午节回家还有三天，应该做不完了。回家事情也不少，剩余 10 多道题只能回北京再做。现在博客文章的分类不清晰，想把所有文章按照生活，技术，算法三部分区分开，展示在不同的 tab 里，自己好检索，也方便别人阅读。

## Project Doris

Project Doris 基本功能开发的差不多了，到目前实现的功能如下。

1. 加上了 clerk 用户登录，主要是避免被坏人刷页面，把 vercel 的免费带宽刷没了。
2. 把证监会和中证指数的查询都集成进来了，现在可以直接在网页查看，哪个更新了就点击按钮发送邮件。
3. 邮箱发送列表从环境变量储存到了 localstorage。写了个 hooks 把邮箱列表存在浏览器，方便我检查调试。

接下来还有些优化的 todo。

1. 要调整一下 UI。看到一个组件库叫 shadcn，也是 vercel 生态里的，准备集成进来，美化一下。
   - 加上 top banner，展示个人头像和登录状态。
   - 加上面包屑导航。
   - 加上 footer。
   - 把现在的 Link 用 Card 包一下，好看点。最好再加上一点动画效果，可以看看 motion framer。
   - 现在的列表是 div 按 flex 布局模拟的，看看有没有好看的列表展现形式。
2. 加上只有管理员用户才能发送邮件的功能。
3. 现在查询证监会的接口是写死的 pagesize 500，准备改成分批次查询 2000 条，待全部返回后再展示，现在 1 个接口大约 1 秒，分成 4-5 个请求，大约一共 5、6 秒内能返回，应该不会超时。下周试试。
4. 加上 cron job。中证指数和证监会发布公告的时间不定，怎么设置 cron job 是个问题，还需要重试和通知机制。不过这个优先级不高，因为已经部署到了 vercel，每天晚上九十点上去看看点点，成本很低。
5. 发送邮件现在是古早的 html 字符串拼接方式，准备改成 react email 和 resend。不过前周试了下，有 bug 导致变异报错，issue 里很多人也提了，抽时间看看解决没有。

大概反思总结了一下，字数有点超了，后面会把这段抽出来，专门写篇博客来记录，题目应该是 use next.js app router to build a web app to send email 之类的。

## Reading

上周翻完了《南北战争三百遍》的第一章。大概思路，我总结如下。

第一，早期草原民族无法形成强大的中央集权是由松散的社会结构导致的。匈奴鲜卑逐水草而居，没有大一统的概念和习惯。即使某一时间有一个强力领袖统一部落，但是领袖消亡以后部落还会重回分散的状态。

第二，早期骑兵是弓骑，主要靠射箭，北方游牧民族善于骑射。从卫青霍去病时代开始，汉朝骑兵开始从弓骑向铁骑转型，从骑射向冲锋转型。李广为什么战功不及卫霍，就是因为出生陇西，精于骑射，战术思路没有成功转型为铁骑冲锋。

第三，骑兵冲锋需要强大严厉的指挥权发号施令。汉朝军队严明，能更好的实施冲锋。匈奴骑兵因为第一点，无法做到令行禁止，所以还是停留在骑射的战术层面。

第四，马镫的出现，也改变了骑兵的作战方式。最先是弓箭，后来用戟，最后用马槊。没有马镫时，骑士在冲锋刺杀对方，自己也可能会掉下马，也很危险，马镫出现以后可以反作用力怼住，这种情况下用马槊，可以给敌人来个透心凉。

学术论文不如社科读物好看，后面两章粗略翻了一下，细致讲解魏晋南北朝的几场大战，也很精彩。但是感觉最近看魏晋南北朝的题材比较多，准备放放，有空了再回来看。

接下来准备看《小而美》，讲创业经营的，学习一下。

写到这里，一个小时了，天也热起来，该去叫 Doris 起床了。
